# 機能仕様書: GitHubによる職務経歴書管理

**機能ブランチ**: `001-manage-resume-gh`  
**作成日**: 2025-12-01  
**ステータス**: ドラフト  
**入力**: ユーザー記述: "職務経歴書をGitHubで管理できるようにしたい... (GitHub ActionsとPagesの記事を参照)" + "PDF生成も追加したい (md-to-pdf)"

## ユーザーシナリオとテスト *(必須)*

### ユーザーストーリー 1 - 職務経歴書の作成とバージョン管理 (優先度: P1)

ユーザーはリポジトリ内で職務経歴書をMarkdownドキュメントとして作成・維持し、変更履歴の管理や容易な編集を行えるようにする。

**この優先度の理由**: これはリポジトリの根本的なデータであり目的である。gitで職務経歴書の内容が管理されなければ、他の機能は無意味となる。

**独立したテスト**: Markdownファイルを作成し、編集を行い、gitの履歴に変更が反映されていることを確認することで完全にテスト可能。

**受け入れシナリオ**:

1. **前提** 空のリポジトリがある状態、**もし** ユーザーが内容を含む `resume.md` ファイルを追加してプッシュした場合、**ならば** ファイルがリポジトリで追跡される。
2. **前提** 既存の `resume.md` がある状態、**もし** ユーザーが内容を修正してプッシュした場合、**ならば** 履歴に特定の変更（差分）が表示される。

---

### ユーザーストーリー 2 - 自動品質チェック (優先度: P2)

変更が提案されるたびに、システムはLintツールを使用して職務経歴書の誤字やフォーマットの問題を自動的にチェックする。

**この優先度の理由**: 公開前に職務経歴書がプロフェッショナルでエラーがないことを保証する。Zennの記事の推奨に従い `textlint` と `markdownlint` を使用する。

**独立したテスト**: 既知のLintエラーを含むプルリクエストを作成し、CIパイプラインが失敗することを確認することでテスト可能。

**受け入れシナリオ**:

1. **前提** 日本語の記述エラー（例：「ら抜き言葉」）を含むプルリクエスト、**もし** CIワークフローが実行された場合、**ならば** `textlint` がエラーを報告しチェックが失敗する。
2. **前提** 無効なMarkdown構文を含むプルリクエスト、**もし** CIワークフローが実行された場合、**ならば** `markdownlint` がエラーを報告しチェックが失敗する。
3. **前提** 正しい内容とフォーマットのプルリクエスト、**もし** CIワークフローが実行された場合、**ならば** すべてのLintチェックが通過する。

---

### ユーザーストーリー 3 - 自動公開 (優先度: P3)

変更が受け入れられた際、システムは職務経歴書の最新版をWebページ (GitHub Pages) に自動的に公開する。

**この優先度の理由**: エンドユーザーが見る成果物（プレゼンテーション層）を提供する。

**独立したテスト**: mainブランチへの変更をマージし、公開URLが更新されることを確認することでテスト可能。

**受け入れシナリオ**:

1. **前提** mainブランチへのマージが成功した状態、**もし** デプロイワークフローが完了した場合、**ならば** 公開GitHub PagesのURLに更新された職務経歴書の内容が表示される。
2. **前提** Markdownスタイル（見出し、リスト）を含む職務経歴書、**もし** 公開された場合、**ならば** Webページでこれらのスタイルが正しく（HTMLとして）レンダリングされる。

---

### ユーザーストーリー 4 - PDF自動生成とダウンロード (優先度: P3)

職務経歴書の更新時（タグ作成時またはマージ時）に、システムはMarkdownからPDFを自動生成し、ダウンロード可能な形式で提供する。

**この優先度の理由**: 提出用としてPDF形式が求められる場合に対応するため。

**独立したテスト**: CIパイプラインが実行された後、アーティファクトまたはリリースアセットとしてPDFが生成されているか確認する。

**受け入れシナリオ**:

1. **前提** `resume.md` が正しくフォーマットされている、**もし** CIワークフロー（PDF生成ジョブ）が実行された場合、**ならば** 内容が反映されたPDFファイルが生成される。
2. **前提** PDF生成が完了した、**もし** アーティファクトまたはリリースページを確認した場合、**ならば** 生成されたPDFがダウンロード可能になっている。

### エッジケース

- ビルド/デプロイが失敗した場合はどうなるか？（例：GitHub Pagesの停止や設定エラー） -> リポジトリの状態は変わらないが、公開サイトは古いままになる可能性がある。ワークフローログは失敗を示す必要がある。
- 職務経歴書ファイルがリネームまたは移動された場合はどうなるか？ -> ビルドスクリプトが特定のパスを期待している場合、失敗する可能性がある。設定でエントリーポイントを定義する必要がある。
- PDF変換でレイアウトが崩れる場合は？ -> CSSによる調整が必要になる可能性がある。デフォルトのスタイルで許容範囲内か確認する。

### 前提条件

- **GitHubアカウント**: ユーザーはGitHubアカウントを持ち、リポジトリ/Actionsを作成する権限がある。
- **公開/非公開**: リポジトリの可視性はGitHub Pagesのデプロイを許可する設定である（パブリックリポジトリまたはProアカウント）。
- **ツール**: ユーザーは品質ゲートとして `textlint` と `markdownlint` の使用を受け入れる。

## 要件 *(必須)*

### 機能要件

- **FR-001**: システムは職務経歴書をMarkdown形式（例：`resume.md` または `README.md`）で保存できるようにしなければならない。
- **FR-002**: システムは、記述エラーを検出するために、すべてのプッシュおよびプルリクエストで日本語プリセットを用いた `textlint` を実行しなければならない。
- **FR-003**: システムは、Markdownのフォーマット基準を強制するために、すべてのプッシュおよびプルリクエストで `markdownlint` を実行しなければならない。
- **FR-004**: システムは、Markdownを静的HTMLページにビルドする（またはGitHub Pages組み込みのJekyll/Markdownサポートを使用する）GitHub Actionsワークフローを持たなければならない。
- **FR-005**: システムは、デフォルトブランチ（`main`）へのプッシュ時に、生成されたページを自動的にGitHub Pagesへデプロイしなければならない。
- **FR-006**: システムは、職務経歴書のための永続的な公開URLを提供しなければならない。
- **FR-007**: システムは、GitHub Actionsを使用してMarkdownからPDFを生成しなければならない（`md-to-pdf` 等を使用）。
- **FR-008**: システムは、生成されたPDFをGitHub Actionsのアーティファクトとして保存（またはリリースページにアップロード）しなければならない。

### 主要エンティティ *(データが関与する場合)*

- **職務経歴書ドキュメント**: 構造化された職務経歴を含むMarkdownファイル。
- **Lint設定**: ルールを定義する `textlint`（例：`.textlintrc`）および `markdownlint`（例：`.markdownlint.json`）の設定ファイル。
- **CI/CDワークフロー**: 自動化手順を定義する `.github/workflows/` 内のYAMLファイル。
- **PDFスタイルシート**: PDF生成時のレイアウトを定義するCSSファイル（必要な場合）。

## 成功基準 *(必須)*

### 測定可能な成果

- **SC-001**: 職務経歴書がGitHub PagesのURL経由で一般公開されアクセス可能である（HTTP 200 OK）。
- **SC-002**: 標準的な職務経歴書の更新において、CIパイプラインが5分以内に完了する。
- **SC-003**: マージ前にプルリクエストの100%がLintエラーについて自動的にチェックされる。
- **SC-004**: `main` にプッシュされた有効なMarkdownの変更が、10分以内に公開サイトに反映される。
- **SC-005**: 生成されたPDFが日本語の文字化けなく閲覧可能である。
